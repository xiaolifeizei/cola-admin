# Cola-Ui 前端文档

## 序

### 项目地址

- 后端地址：https://gitee.com/xiaolifeizei/cola-admin
- 前端地址：https://gitee.com/xiaolifeizei/cola-ui

### 在线演示

- 演示地址：[http://www.cola-admin.vip](https://gitee.com/link?target=http%3A%2F%2Fwww.cola-admin.vip)
- 默认用户：admin
- 默认密码：123123

### 前端介绍

Cola-Ui基于Vue-Element-Admin框架开发，参考了Eladmin-Web的部分代码，项目地址如下

Vue-Element-Admin: https://gitee.com/panjiachen/vue-element-admin

Eladmin-web：https://gitee.com/elunez/eladmin-web

感谢两个优秀的开源前端框架，大佬V5!

### 目录结构

```
cola-ui
├──build         # 构建配置目录
├──mock          # mock数据
├──public        # 静态资源
├──src
|  ├─api         # 与后端交互的接口
|  ├─components  # 公共组件
|  ├─layout      # 页面布局
|  ├─libs		 # 自定义UI
|  ├─router		 # 路由
|  ├─store       # vuex
|  ├─styles      # 自定义样式
|  ├─utils		 # axios封装、鉴权封装等
|  └─views   	 # 页面
└──nginx.conf    # nginx配置文件
```



## 环境要求

### 基础开发环境

- NodeJs v16+
- npm  v8+

### 推荐IDE

- WebStorm 

## 环境准备

### 导入项目

1. 进入cola-ui项目首页https://gitee.com/xiaolifeizei/cola-ui

2. 复制项目地址

   ![image-20220727164025952](https://s1.328888.xyz/2022/07/27/D8BWk.png)

3. 打开WebStorm，依次点击File->New->Project from Version Control...

![image-20220727164053472](https://s1.328888.xyz/2022/07/27/D8wBE.png)

4. 在弹出的对话框中粘贴复制的项目地址

   ![image-20220727164335325](https://s1.328888.xyz/2022/07/27/D8ot0.png)

5. IDE可能会弹出对话框，点击“Trust Project”

   ![image-20220727164406221](https://s1.328888.xyz/2022/07/27/D8VBo.png)

6. 等待代码下载完成

7. 安装依赖

   ![image-20220727164656874](https://s1.328888.xyz/2022/07/27/D8xmC.png)

### 运行项目

   1. 运行前请先启动cola-admin后台服务，请在.env.development文件中修改后台地址及端口，默认为8085端口

![image-20220727170934632](https://s1.328888.xyz/2022/07/27/D8v4w.png)

   2. 输入命令npm run dev启动服务

   ![image-20220727171134439](https://s1.328888.xyz/2022/07/27/DUugo.png)

   3. 启动成功后会自动打开浏览器


   ![image-20220727171238339](https://s1.328888.xyz/2022/07/27/DUTI5.png)

## 开发初探

### 第一个CURD

以后端项目中的学生管理为例，后端具体内容请参考文档：https://gitee.com/xiaolifeizei/cola-admin/wikis/%E5%90%8E%E7%AB%AF%E6%96%87%E6%A1%A3

#### 添加菜单

进入系统后点击“系统后台管理”--“菜单管理”，再点击新增按钮

![image-20220728094101249](https://s1.328888.xyz/2022/07/28/DQpai.png)

填写菜单内容后点击确定按钮完成添加

![image-20220728094711222](https://s1.328888.xyz/2022/07/28/DQRY0.png)

添加子菜单，在列表中选中刚添加的学生信息管理菜单项，再点击新增按钮

![image-20220728094759838](https://s1.328888.xyz/2022/07/28/DQiup.png)

填写子菜单信息

![image-20220728095932522](https://s1.328888.xyz/2022/07/28/DSk07.png)

最终效果如下

![image-20220728095957211](https://s1.328888.xyz/2022/07/28/DS12k.png)

#### 编写API

在src\api目录下新建student目录，并添加index.js文件

![image-20220728090819994](https://s1.328888.xyz/2022/07/28/DQPS6.png)

打开src\api\student\index.js

```java
import request from '@/utils/request'

/**
 * 添加学生
 * @param data
 * @returns {*}
 */
export function addStudent(data) {
  return request({
    url: '/student/addStudent',
    method: 'post',
    data
  })
}

/**
 * 修改学生信息
 * @param data
 * @returns {*}
 */
export function editStudent(data) {
  return request({
    url: '/student/editStudent',
    method: 'post',
    data
  })
}

/**
 * 删除学生信息
 * @param data
 * @returns {*}
 */
export function deleteStudent(data) {
  return request({
    url: '/student/deleteStudent',
    method: 'post',
    data
  })
}

/**
 * 分页查询
 * @param data
 * @returns {*}
 */
export function getStudentPage(data) {
  return request({
    url: '/student/getStudentPage',
    method: 'post',
    data
  })
}

```

#### 编写主页面

打开src\views目录，新建student目录，然后再新建index.vue

![image-20220728091742156](https://s1.328888.xyz/2022/07/28/DQUJj.png)

index.vue为主页面，主要功能是查询列表的展示以及查询、修改、删除等组件的容器。复制如下代码到index.vue中

```vue
<template>
  <!--  主页面容器-->
  <div class="app-container">
    <!-- 查询容器-->
    <table-query></table-query>
    <!-- 表格工具条 -->
    <table-header></table-header>
    <!-- 表格 -->
    <el-table
      ref="indexTable"
      v-loading="tableLoading"
      :data="list"
      fit
      border
      highlight-current-row
      style="width: 100%"
      class="indexTable"
      size="mini"
      @selection-change="handleSelectionChange"
    >
      <el-table-column align="center" type="selection" width="60" />
      <!-- 显示字段 -->
      <el-table-column label="id" prop="id" width="80" />
      <el-table-column label="姓名" prop="name" width="200" />
      <el-table-column label="年龄" prop="age" width="80" />
      <el-table-column label="姓别" prop="sex" width="80" />
      <el-table-column label="地址" prop="address" />
      <el-table-column label="创建时间" prop="createTime" width="150px" />
      <el-table-column label="操作" width="120px" align="center">
        <template v-slot="scope">
          <div style="display: flex;">
            <!-- 修改按钮 -->
            <el-button type="primary" icon="el-icon-edit" size="mini" @click="toEdit(scope.row)" />
            <!-- 删除按钮 -->
            <el-button type="danger" icon="el-icon-delete" size="mini" @click="toDelete(scope.row)" />
          </div>
        </template>
      </el-table-column>
    </el-table>
  </div>
</template>

<script>

import { getStudentPage } from '@/api/student'

export default {
  name: 'Student',
  data() {
    return {
      tableLoading: false,
      list: []
    }
  },
  mounted() {
    // 增加刷新方法
    this.$refs.indexTable.refresh = this.getTableData
    // 页面加载完成后自动查询数据
    this.getTableData()
  },
  methods: {
    // 控制只能单选
    handleSelectionChange(val) {
      if (val.length > 1) {
        this.$refs.indexTable.clearSelection()
        this.$refs.indexTable.toggleRowSelection(val.pop())
      }
    },
    getTableData() {
      this.tableLoading = true
      getStudentPage().then(response => {
        if (response.data.page) {
          this.list = response.data.page.records ? response.data.page.records : []
        }
        this.tableLoading = false
      }).catch(() => {
        this.tableLoading = false
      })
    },
    toEdit(row) {
    },
    toDelete(row) {
    }
  }
}
</script>

<style scoped>
/* 取消表头上的选择框 */
.indexTable /deep/ .el-table-column--selection.is-leaf .el-checkbox {
  display: none;
}
</style>

```

#### 添加路由

打开src\router\index.js

![image-20220728095421241](https://s1.328888.xyz/2022/07/28/DSu0B.png)

添加学生管理路由映射

![image-20220728100224382](https://s1.328888.xyz/2022/07/28/DSc1w.png)

刷新页面后可以看到新增加的菜单，效果如下

![image-20220728174316492](https://s1.328888.xyz/2022/07/28/Dq8kE.png)

#### 添加查询条件

1. 在src\views\student目录下新建query.vue

![image-20220728102647893](https://s1.328888.xyz/2022/07/28/DS7by.png)

2. 编写查询条件代码

```vue
<template>
  <!-- 查询条件容器 -->
  <div class="query-content">
    <!-- 表单 -->
    <el-form ref="queryForm" :model="query.data" :inline="true">
      <!-- 查询条件 -->
      <el-form-item prop="name">
        <el-input v-model="query.data.name" :clearable="true" placeholder="请输入学生姓名" />
      </el-form-item>
      <!-- 查询条件 -->
      <el-form-item prop="sex">
        <el-select v-model="query.data.sex" :clearable="true" placeholder="请选择姓别">
          <el-option label="女" :value="0" />
          <el-option label="男" :value="1" />
        </el-select>
      </el-form-item>
      <!-- 查询按钮 -->
      <el-button type="primary" icon="el-icon-search" @click="doQuery"> 查 询 </el-button>
      <el-button type="success" icon="el-icon-refresh-right" @click="doReset"> 重 置 </el-button>
    </el-form>
  </div>
</template>

<script>
export default {
  name: 'StudentQuery',
  props: {
    // 主页面传过来的查询对象
    query: {
      type: Object,
      require: true,
      default() {
        return {
          data: {
            name: '',
            sex: ''
          },
          currentPage: 1
        }
      }
    }
  },
  data() {
    return {
      // 主页面table对象
      table: {}
    }
  },
  mounted() {
    // 获取父页面table对象
    this.table = this.$parent.$parent.$children.find(vc => vc && vc.tableId)
  },
  methods: {
    doQuery() {
      // 调用父页面刷新方法执行查询操作
      this.table.refresh()
    },
    doReset() {
      // 重置时清空表单信息
      this.$refs.queryForm.resetFields()
      // 重置时重新刷新
      this.table.refresh()
    }
  }
}
</script>

<style scoped>

</style>

```

3. 在主页面中添加查询条件组件和查询条件对象

![image-20220728104324071](https://s1.328888.xyz/2022/07/28/DSXDP.png)

4. 页面中添加引用

![image-20220728104540875](https://s1.328888.xyz/2022/07/28/DSY56.png)

5. 修改查询方法，将查询条件对象传入

   ![修改查询方法](https://s1.328888.xyz/2022/07/28/DqsuK.png)

6. 最终效果

![image-20220728174401186](https://s1.328888.xyz/2022/07/28/DqUJJ.png)

7. 测试查询

![image-20220728174420138](https://s1.328888.xyz/2022/07/28/DqxWw.png)

#### 添加分页

